#start Posting Rules htmlcode checker
dprint("Checking for html tags status");
$1="";$htf=0;
$ua->requests_redirectable;
for($i=1;$i<=100;$i++){
    if($ver =~ m/vBulletin 4/i){
        $source=$ua->get("$target/forumdisplay.php?$i")->decoded_content;
    }elsif($ver =~ m/vBulletin 3/i){
        $source=$ua->get("$target/forumdisplay.php?f=$i")->decoded_content;
    }
    if($source !~ m/Invalid Forum specified/i){
        $source =~ /HTML code is \<strong\>(.*?)\<\/strong\>/;
        if($1 =~ m/On/i){
            if($ver =~ m/vBulletin 4/i){
                tprint("html tag are \"ON\" and target is vulnerable to XSS Attack\n$target/forumdisplay.php?$i");
            }elsif($ver =~ m/vBulletin 3/i){
                tprint("html tag are \"ON\" and target is vulnerable to XSS Attack\n$target/forumdisplay.php?f=$i");
            }
            $htf=1;
        }
    }else{
        goto enhtml;
    }
}
enhtml:;
if($htf==0){
    fprint("HTML tag are Disable");
}

#end Posting Rules htmlcode checker
